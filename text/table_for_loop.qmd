---
title: Table in for loop
---

```{r include=FALSE}
library(knitr)
library(flextable)
opts_chunk$set(echo = FALSE)
```

This is an example of a Tables qmd with separate qmds for the individual tables. The table code is in the `tables` folder. `Table1` is a simple table. `Table_Counts` is a table function that is then called to make tables with the same format but different input data. For this example, I am only going to use `kable()` for all output types. See `Tables.Rmd` and `Table_Counts_flex.Rmd` for examples of using the **kableExtra**, **xtable** and **flextable** packages. 

```{r child=here::here("tables", "Table_Counts_flex.Rmd")}
```

```{r}
ft <- qflextable(head(airquality))
```

## Captions

Now, let's add a caption with `set_caption`:

```{r ft.align="left"}
library(officer)
cap_tab <- officer::run_autonum(seq_id = "tab", bkm = "tab1")
set_caption(ft, 
  caption = "airquality dataset", 
  style = "Table Caption", 
  autonum = cap_tab)
```

Or use knitr chunk options:

```{r ft.align="center", tab.cap='airquality dataset', tab.id='tab2', label='tab2'}
ft
```

## Cross-references

If your output is `officedown::rdocx_document` or `bookdown::`, then you will have access to auto-referencing via `\@ref(xxx:yyy)` format. 

* Example, this is a reference to Table \@ref(tab:tab1). This is a reference to Table \@ref(tab:tab2).

You can create links but you won't see the table number [the table](#tab:tab1). This works whether you created the table caption with `flextable` or `knitr`.



